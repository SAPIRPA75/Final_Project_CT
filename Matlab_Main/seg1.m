function [BW,maskedImage] = segmentImage(X)
%segmentImage Segment image using auto-generated code from Image Segmenter app
%  [BW,MASKEDIMAGE] = segmentImage(X) segments image X using auto-generated
%  code from the Image Segmenter app. The final segmentation is returned in
%  BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 22-Jan-2024
%----------------------------------------------------


% Adjust data to span data range.
X = imadjust(X);

% Create empty mask
BW = false(size(X,1),size(X,2));

% Draw ROIs

xPos = [257.6102 256.3209 256.3209 254.8884 254.1721 253.0260 251.6651 249.8744 246.2929 244.5739 244.0008 243.0697 242.2101 241.5655 241.2073 240.2045 238.4138 236.9096 234.4026 233.3282 230.7496 229.8900 229.5319 229.5319 229.8184 230.8928 231.5375 231.9673 232.7552 233.7580 238.1273 242.5683 244.5022 248.7283 251.8800 253.5274 254.9600 256.6791 257.6102 258.5414 259.4010 259.9024 260.6186 261.2633 262.0512 262.4093 262.6959 262.9824 263.1256 263.1256 263.0540 262.7675 262.4093 261.9079 261.2633 260.6903 260.1172 259.5442 258.6847 258.3982 257.6819 257.0372 256.9656 256.7507 256.6791 256.2493 256.0344 255.9628 257.0000 257.0000];
yPos = [199.7345 203.1726 203.3159 205.7513 206.8257 207.8285 208.6880 209.4043 210.1922 210.6936 210.8369 211.1234 211.4815 211.7680 211.9829 212.1978 212.5560 212.6276 212.8425 212.9857 213.3439 213.7736 214.9913 216.4239 219.0741 221.0797 221.9393 222.5839 223.0853 223.4435 224.8760 225.0909 225.0909 224.8760 224.3030 224.3030 224.3030 223.9449 223.3719 222.5123 221.2230 220.7216 219.7188 218.7876 217.6416 216.7820 216.0658 214.4183 213.9169 212.9141 211.5532 210.8369 209.9773 209.2611 208.0434 207.4703 206.4675 205.6796 204.8201 204.6052 203.6024 202.8861 202.5996 202.5280 202.3131 202.1698 202.0982 202.0982 200.7013 200.2987];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

% Active contour
iterations = 45;
BW = activecontour(X, BW, iterations, 'edge');

% Create masked image.
maskedImage = X;
maskedImage(~BW) = 0;
end

