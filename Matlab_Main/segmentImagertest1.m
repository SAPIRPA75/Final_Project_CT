function [BW,maskedImage] = segmentImage(X)
%segmentImage Segment image using auto-generated code from Image Segmenter app
%  [BW,MASKEDIMAGE] = segmentImage(X) segments image X using auto-generated
%  code from the Image Segmenter app. The final segmentation is returned in
%  BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 22-Jan-2024
%----------------------------------------------------


% Adjust data to span data range.
X = imadjust(X);

% Create empty mask
BW = false(size(X,1),size(X,2));

% Draw ROIs

xPos = [254.5609 254.1569 254.0761 253.5106 253.3490 253.2682 252.9450 252.9450 252.7834 252.7026 252.5410 252.5410 252.1371 251.9755 251.5715 251.3291 251.2483 251.0867 250.6827 250.5211 250.4404 250.2788 250.1172 250.0364 249.7132 249.3092 249.2284 249.0668 247.9357 247.4509 246.0774 245.6734 245.5926 245.2694 243.9767 243.6535 243.4112 243.0880 242.7648 242.2800 241.7953 241.0681 240.0178 239.5330 239.0482 238.8058 237.6468 236.9455 236.0000 235.0000 234.0000 233.0000 232.0000 231.0000 230.0000 229.0000 228.0545 227.3532 227.0545 226.4441 226.1210 225.3130 224.8282 224.4243 224.0203 223.4547 223.0507 222.6468 222.4852 222.2428 222.1620 222.0812 222.0812 221.8388 221.8388 221.7580 221.6772 221.6772 221.6772 221.6772 221.6772 221.4348 221.3540 221.2732 221.2732 221.4348 221.7580 222.0004 222.5660 222.8083 223.0507 223.3739 223.8587 224.2627 224.6666 234.7661 235.0892 235.5740 235.7356 235.8972 235.9780 236.5436 236.9475 237.5939 238.3211 238.5634 238.7250 239.3714 239.6138 239.8562 239.9370 240.0178 240.7449 240.8257 240.9873 241.0681 241.2297 241.4721 241.6337 241.7953 241.8760 241.9568 242.0376 242.4416 243.0880 243.8959 244.0575 244.2191 244.4615 244.7847 245.9158 246.0774 246.6430 246.8854 247.4509 247.6933 248.3397 249.5516 249.7132 250.9251 251.2483 251.5715 251.8947 252.3794 253.9953 254.5609 254.7225 254.8841 255.2881 255.5305 255.6113 255.7728 255.9344 256.0152 256.0960 256.9848 257.1464 257.3887 257.3887 257.7119 257.7927 258.1967 259.2470 259.3278 263.0444 263.0444 263.0444 262.9636 262.8828 262.8828 262.6404 262.6404 262.6404 256.4192 256.3384 256.1768 255.9344 255.3689 255.2881 255.2073 254.9649 254.3993 254.0761];
yPos = [206.5360 208.1516 208.1516 208.9595 209.0402 209.0402 209.2826 209.3634 209.3634 209.3634 209.3634 209.4441 209.5249 209.5249 209.7673 209.7673 209.7673 209.7673 209.9288 209.9288 210.0904 210.1712 210.1712 210.1712 210.2520 210.5751 210.5751 210.5751 211.1406 211.3829 212.1100 212.3523 212.5139 212.6754 213.1601 213.3217 213.5641 213.7256 213.8064 214.1295 214.2911 214.5334 214.6142 214.6950 214.9374 214.9374 216.2442 216.4026 216.1897 215.8103 215.6519 216.0000 216.3481 216.2987 216.4077 216.9455 217.2936 216.9455 216.3532 216.3914 216.3914 216.5530 216.6338 216.7146 216.9569 217.0377 217.1185 217.3608 217.5224 217.5224 217.7648 217.7648 217.8455 218.2494 218.4110 218.6534 218.9765 219.0573 219.7843 220.1882 220.2690 220.6729 221.0768 221.4808 221.5615 221.8847 222.0462 222.2886 222.6117 222.6925 222.8541 223.0964 223.5003 223.5811 223.8234 225.9238 225.8430 225.6007 225.5199 225.5199 225.4391 225.2775 225.1967 225.1160 225.1160 225.1160 225.1160 225.1160 225.1160 225.1160 225.1160 225.1160 225.2775 225.4391 225.4391 225.4391 225.5199 225.5199 225.6007 225.6007 225.6007 225.6007 225.6007 225.5199 225.4391 225.1967 225.1967 225.1967 225.1160 225.1160 224.8736 224.8736 224.7121 224.7121 224.4697 224.3081 223.9850 223.6619 223.5811 223.5003 223.4195 223.2580 223.1772 223.0964 222.6117 222.2886 222.2078 221.9654 221.5615 221.4000 221.2384 220.9961 220.6729 220.6729 220.5921 219.4612 219.2188 219.0573 218.9765 218.9765 218.7341 218.5726 217.9263 217.9263 213.4025 212.9986 212.7562 212.5947 212.2715 211.8676 211.3829 211.1406 210.9790 206.4552 206.2936 206.2936 206.2128 206.1321 206.1321 206.1321 206.1321 206.1321 206.1321];
m = size(BW, 1);
n = size(BW, 2);
addedRegion = poly2mask(xPos, yPos, m, n);
BW = BW | addedRegion;

% Active contour
iterations = 50;
BW = activecontour(X, BW, iterations, 'edge');

% Clear borders
BW = imclearborder(BW);

% Create masked image.
maskedImage = X;
maskedImage(~BW) = 0;
end

